<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Manga Quiz Hub</title>
<link href="https://fonts.googleapis.com/css2?family=Bangers&family=Komika+Axis&display=swap" rel="stylesheet">
<style>
    /* --- STYLE IDENTIQUE AU PRÉCÉDENT --- */
    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    body {
        margin: 0; padding: 0; 
        background: linear-gradient(135deg, #1a1a1a 0%, #0d0d0d 100%);
        height: 100vh; width: 100vw; 
        font-family: 'Komika Axis', sans-serif; 
        color: #fff; overflow: hidden;
        display: flex; justify-content: center; align-items: center;
    }
    .screen {
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        display: none; flex-direction: column; align-items: center;
        padding: 20px; overflow-y: auto;
    }
    .screen.active { display: flex; animation: fadeIn 0.5s; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

    /* MENU */
    #menu-screen { background: url('bg-menu.jpg') center/cover no-repeat; background-color: #222; }
    .menu-overlay { background: rgba(0,0,0,0.85); width: 100%; height: 100%; position: absolute; top:0; left:0; z-index:0; }
    .menu-content { z-index: 1; width: 100%; max-width: 400px; text-align: center; margin-top: 50px;}
    .app-title {
        font-family: 'Bangers'; font-size: 50px; color: #ffcc00;
        -webkit-text-stroke: 2px #000; text-shadow: 4px 4px 0 #ff0055;
        margin-bottom: 30px; line-height: 1; transform: rotate(-3deg);
    }
    .quiz-card {
        background: #fff; border: 4px solid #000; 
        margin-bottom: 15px; padding: 10px; border-radius: 10px;
        box-shadow: 5px 5px 0 #000; transform: skew(-3deg);
        cursor: pointer; transition: transform 0.1s;
    }
    .quiz-card:active { transform: skew(-3deg) scale(0.95); }
    .quiz-card h3 { color: #000; margin: 0; font-family: 'Bangers'; font-size: 22px; }
    .quiz-tag { background: #ff0055; color: #fff; padding: 2px 8px; font-size: 12px; border-radius: 4px; display: inline-block; margin-bottom: 5px;}

    /* JEU */
    #game-screen { background: linear-gradient(135deg, #006994 0%, #003366 100%); }
    .header-zone { margin-bottom: 20px; text-align: center; width: 100%; max-width: 500px; }
    .game-title { font-family: 'Bangers'; font-size: 30px; color: #ffcc00; -webkit-text-stroke: 1px #000; margin-top: 40px; }
    
    .duel-container { display: flex; justify-content: space-between; align-items: center; width: 100%; max-width: 400px; height: 220px; }
    .card-box { width: 45%; height: 100%; background: #000; border: 3px solid #fff; border-radius: 8px; overflow: hidden; position: relative; }
    .card-img { width: 100%; height: 100%; object-fit: cover; }
    
    .vs-text { font-family: 'Bangers'; font-size: 40px; color: #ff0055; -webkit-text-stroke: 1px #fff; z-index: 10; }

    .mystery-overlay { 
        position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
        background: repeating-linear-gradient(45deg, #111, #111 10px, #222 10px, #222 20px);
        display: flex; justify-content: center; align-items: center; cursor: pointer;
    }
    .mystery-text { font-family: 'Bangers'; font-size: 50px; }
    
    .btn-next {
        margin-top: 30px; padding: 15px 40px; font-family: 'Bangers'; font-size: 24px;
        background: #ffcc00; border: 3px solid #000; box-shadow: 4px 4px 0 #000;
        color: #000; display: none; cursor: pointer;
    }
    .btn-back {
        position: absolute; top: 15px; left: 15px; 
        background: rgba(0,0,0,0.6); border: 2px solid #fff; color: #fff;
        padding: 8px 12px; font-family: 'Komika Axis'; font-size: 14px; z-index: 100;
        cursor: pointer; border-radius: 5px;
    }
    .char-name { font-family: 'Bangers'; font-size: 18px; text-transform: uppercase; margin-top: 5px; text-shadow: 2px 2px 0 #000; }
</style>
</head>
<body>

    <div id="menu-screen" class="screen active">
        <div class="menu-overlay"></div>
        <div class="menu-content">
            <h1 class="app-title">MANGA<br>QUIZ HUB</h1>
            <div id="quiz-list-container"></div>
        </div>
    </div>

    <div id="game-screen" class="screen">
        <button class="btn-back" onclick="showScreen('menu-screen')">⬅ MENU</button>

        <div class="header-zone">
            <div class="game-title" id="roundTitle">ROUND 1</div>
        </div>

        <div class="duel-container">
            <div class="card-wrapper" style="width:45%; display:flex; flex-direction:column; align-items:center;">
                <div class="card-box">
                    <img id="img-left" src="" class="card-img" onerror="this.src='https://via.placeholder.com/150?text=Erreur+Image'">
                </div>
                <div class="char-name" id="name-left">NOM</div>
            </div>

            <div class="vs-text">VS</div>

            <div class="card-wrapper" style="width:45%; display:flex; flex-direction:column; align-items:center;">
                <div class="card-box" onclick="revealCard()">
                    <img id="img-right" src="" class="card-img" onerror="this.src='https://via.placeholder.com/150?text=Erreur+Image'">
                    <div class="mystery-overlay" id="overlay-right">
                        <div class="mystery-text">?</div>
                    </div>
                </div>
                <div class="char-name" id="name-right">???</div>
            </div>
        </div>

        <button class="btn-next" id="btn-next" onclick="nextRound()">SUIVANT ▶</button>
    </div>

<script>

    // ----------------------------------------------------
    // 1. LA GROSSE LISTE DE PERSONNAGES (DATABASE)
    // ----------------------------------------------------
    // C'est ici que tu dois lister tes 50+ fichiers images.
    // Assure-toi que les noms de fichiers (ex: "luffy.jpg")
    // correspondent EXACTEMENT à ce que tu upload sur GitHub.
    // ----------------------------------------------------
    
    const OP_POOL = [
        { name: "Monkey D. Luffy", img: "luffy.jpg" },
        { name: "Roronoa Zoro", img: "zoro.jpg" },
        { name: "Nami", img: "nami.jpg" },
        { name: "Usopp", img: "usopp.jpg" },
        { name: "Sanji", img: "sanji.jpg" },
        { name: "Chopper", img: "chopper.jpg" },
        { name: "Nico Robin", img: "robin.jpg" },
        { name: "Franky", img: "franky.jpg" },
        { name: "Brook", img: "brook.jpg" },
        { name: "Jinbe", img: "jinbe.jpg" },
        { name: "Trafalgar Law", img: "law.jpg" },
        { name: "Eustass Kid", img: "kid.jpg" },
        { name: "Shanks", img: "shanks.jpg" },
        { name: "Buggy", img: "buggy.jpg" },
        { name: "Mihawk", img: "mihawk.jpg" },
        { name: "Crocodile", img: "crocodile.jpg" },
        { name: "Doflamingo", img: "doflamingo.jpg" },
        { name: "Boa Hancock", img: "hancock.jpg" },
        { name: "Whitebeard", img: "whitebeard.jpg" },
        { name: "Marco", img: "marco.jpg" },
        { name: "Ace", img: "ace.jpg" },
        { name: "Sabo", img: "sabo.jpg" },
        { name: "Blackbeard", img: "blackbeard.jpg" },
        { name: "Akainu", img: "akainu.jpg" },
        { name: "Aokiji", img: "kuzan.jpg" },
        { name: "Kizaru", img: "kizaru.jpg" },
        { name: "Fujitora", img: "fujitora.jpg" },
        { name: "Smoker", img: "smoker.jpg" },
        { name: "Rob Lucci", img: "lucci.jpg" },
        { name: "Katakuri", img: "katakuri.jpg" },
        { name: "Big Mom", img: "bigmom.jpg" },
        { name: "Kaido", img: "kaido.jpg" },
        { name: "Yamato", img: "yamato.jpg" },
        { name: "King", img: "king.jpg" },
        { name: "Queen", img: "queen.jpg" },
        { name: "Carrot", img: "carrot.jpg" },
        { name: "Bartolomeo", img: "barto.jpg" },
        { name: "Cavendish", img: "cavendish.jpg" },
        { name: "Reiju", img: "reiju.jpg" },
        { name: "Perona", img: "perona.jpg" },
        { name: "Enel", img: "enel.jpg" },
        { name: "Garp", img: "garp.jpg" },
        { name: "Sengoku", img: "sengoku.jpg" },
        { name: "Rayleigh", img: "rayleigh.jpg" },
        { name: "Roger", img: "roger.jpg" }
    ];

    // Les catégories pour structurer un équipage
    const CREW_ROLES = ["CAPITAINE", "BRAS DROIT", "NAVIGATEUR", "CUISINIER", "MÉDECIN", "SNIPER", "CHARPENTIER", "MUSICIEN"];

    // ----------------------------------------------------
    // 2. CONFIGURATION DES QUIZ
    // ----------------------------------------------------
    const QUIZ_CONFIG = [
        {
            id: "op_crew_random",
            title: "COMPOSE TON ÉQUIPAGE (ALÉATOIRE)",
            tag: "ONE PIECE",
            bg: "linear-gradient(135deg, #006994 0%, #003366 100%)",
            mode: "random_pool", // Ce mode déclenche le mélange
            pool: OP_POOL,
            roles: CREW_ROLES
        },
        {
            id: "naruto_simple",
            title: "NARUTO VS (FIXE)",
            tag: "NARUTO",
            bg: "linear-gradient(135deg, #f16913 0%, #d63d09 100%)",
            mode: "fixed",
            questions: [
                 { title: "LE PLUS RAPIDE ?", left: {name:"Minato", img:"minato.jpg"}, right: {name:"Tobirama", img:"tobirama.jpg"} }
            ]
        }
    ];

    // Variables globales
    let currentQuizConfig = null;
    let activeQuestions = []; // Contiendra les questions générées
    let currentQuestionIndex = 0;

    // --- INITIALISATION DU MENU ---
    const menuContainer = document.getElementById('quiz-list-container');
    
    QUIZ_CONFIG.forEach(quiz => {
        const btn = document.createElement('div');
        btn.className = 'quiz-card';
        btn.innerHTML = `<span class="quiz-tag">${quiz.tag}</span><h3>${quiz.title}</h3>`;
        btn.onclick = () => startQuiz(quiz.id);
        menuContainer.appendChild(btn);
    });

    // --- NAVIGATION ---
    function showScreen(screenId) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(screenId).classList.add('active');
    }

    // --- FONCTION MAGIQUE : MÉLANGEUR ---
    // C'est ça qui rend le jeu unique à chaque fois
    function generateRandomQuestions(pool, roles) {
        // 1. On copie la liste pour ne pas abîmer l'originale
        let tempPool = [...pool];
        
        // 2. On mélange (Shuffle)
        tempPool.sort(() => Math.random() - 0.5);
        
        let questions = [];
        
        // 3. On crée les duels en fonction des rôles
        // On a besoin de 2 persos par rôle
        for (let i = 0; i < roles.length; i++) {
            // S'il n'y a plus assez de persos, on arrête
            if (tempPool.length < 2) break;

            const char1 = tempPool.pop(); // On prend le dernier et on l'enlève de la liste
            const char2 = tempPool.pop(); // On prend l'avant-dernier

            questions.push({
                title: roles[i],
                left: char1,
                right: char2
            });
        }
        return questions;
    }

    function startQuiz(quizId) {
        currentQuizConfig = QUIZ_CONFIG.find(q => q.id === quizId);
        currentQuestionIndex = 0;
        document.getElementById('game-screen').style.background = currentQuizConfig.bg;

        // LOGIQUE DE GÉNÉRATION
        if (currentQuizConfig.mode === "random_pool") {
            // Si c'est le mode aléatoire, on génère les questions maintenant
            activeQuestions = generateRandomQuestions(currentQuizConfig.pool, currentQuizConfig.roles);
        } else {
            // Sinon on prend les questions fixes
            activeQuestions = currentQuizConfig.questions;
        }

        loadQuestion();
        showScreen('game-screen');
    }

    function loadQuestion() {
        // Reset UI
        document.getElementById('overlay-right').style.display = 'flex';
        document.getElementById('btn-next').style.display = 'none';
        document.getElementById('name-right').innerText = "???";
        document.getElementById('name-right').style.opacity = "0.5";

        if (currentQuestionIndex >= activeQuestions.length) {
            // Fin du jeu
            alert("Équipage complet !");
            showScreen('menu-screen');
            return;
        }

        const data = activeQuestions[currentQuestionIndex];

        // Affichage
        document.getElementById('roundTitle').innerText = data.title;
        
        document.getElementById('img-left').src = data.left.img;
        document.getElementById('name-left').innerText = data.left.name;
        
        document.getElementById('img-right').src = data.right.img;
        // Stockage du nom caché
        document.getElementById('game-screen').dataset.hiddenName = data.right.name;
    }

    function revealCard() {
        document.getElementById('overlay-right').style.display = 'none';
        const realName = document.getElementById('game-screen').dataset.hiddenName;
        document.getElementById('name-right').innerText = realName;
        document.getElementById('name-right').style.opacity = "1";
        document.getElementById('btn-next').style.display = 'block';
    }

    function nextRound() {
        currentQuestionIndex++;
        loadQuestion();
    }

</script>
</body>
</html>
