<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Manga Quiz Hub</title>
<link href="https://fonts.googleapis.com/css2?family=Bangers&family=Komika+Axis&display=swap" rel="stylesheet">
<style>
    /* --- 1. DESIGN G√âN√âRAL --- */
    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
    body {
        margin: 0; padding: 0; 
        background: linear-gradient(135deg, #1a1a1a 0%, #0d0d0d 100%);
        height: 100vh; width: 100vw; 
        font-family: 'Komika Axis', sans-serif; 
        color: #fff; overflow: hidden;
        display: flex; justify-content: center; align-items: center;
    }
    .screen {
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        display: none; flex-direction: column; align-items: center;
        padding: 20px; overflow-y: auto;
    }
    .screen.active { display: flex; animation: fadeIn 0.5s; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

    /* MENU */
    #menu-screen { background: url('https://wallpapers.com/images/hd/one-piece-phone-j3s367d3635k4591.jpg') center/cover no-repeat; background-color: #222; }
    .menu-overlay { background: rgba(0,0,0,0.85); width: 100%; height: 100%; position: absolute; top:0; left:0; z-index:0; }
    .menu-content { z-index: 1; width: 100%; max-width: 400px; text-align: center; margin-top: 50px;}
    .app-title {
        font-family: 'Bangers'; font-size: 50px; color: #ffcc00;
        -webkit-text-stroke: 2px #000; text-shadow: 4px 4px 0 #ff0055;
        margin-bottom: 30px; line-height: 1; transform: rotate(-3deg);
    }
    .quiz-card {
        background: #fff; border: 4px solid #000; 
        margin-bottom: 15px; padding: 15px; border-radius: 10px;
        box-shadow: 5px 5px 0 #000; transform: skew(-3deg);
        cursor: pointer; transition: transform 0.1s; display: flex; align-items: center; justify-content: space-between;
    }
    .quiz-card:active { transform: skew(-3deg) scale(0.95); }
    .quiz-info h3 { color: #000; margin: 0; font-family: 'Bangers'; font-size: 22px; text-align: left; line-height: 1.1;}
    .quiz-tag { background: #ff0055; color: #fff; padding: 2px 8px; font-size: 12px; border-radius: 4px; display: inline-block; margin-bottom: 5px;}
    .quiz-icon { font-size: 30px; margin-right: 15px; }

    /* JEU COMMUN */
    #game-screen { background: #333; transition: background 0.5s; }
    .header-zone { margin-bottom: 10px; text-align: center; width: 100%; max-width: 500px; position: relative; z-index: 10;}
    .game-title { font-family: 'Bangers'; font-size: 28px; color: #ffcc00; -webkit-text-stroke: 1px #000; margin-top: 40px; }
    .btn-back {
        position: absolute; top: 15px; left: 15px; 
        background: rgba(0,0,0,0.6); border: 2px solid #fff; color: #fff;
        padding: 8px 12px; font-family: 'Komika Axis'; font-size: 14px; z-index: 100;
        cursor: pointer; border-radius: 5px;
    }
    .btn-action {
        margin-top: 20px; padding: 10px 30px; font-family: 'Bangers'; font-size: 20px;
        border: 3px solid #000; box-shadow: 4px 4px 0 #000; cursor: pointer;
        display: none; width: 80%; max-width: 300px;
    }
    .btn-next { background: #ffcc00; color: #000; }
    .btn-retry { background: #fff; color: #000; margin-right: 10px; display: inline-block; width: auto; }
    .btn-reveal { background: #ff0055; color: #fff; display: inline-block; width: auto; }

    /* --- MODE 1 : DUEL (Images) --- */
    #mode-duel { display: none; width: 100%; flex-direction: column; align-items: center; }
    .duel-container { display: flex; justify-content: space-between; align-items: center; width: 100%; max-width: 400px; height: 220px; margin-top: 20px;}
    .card-wrapper { width: 45%; height: 100%; display: flex; flex-direction: column; align-items: center; }
    .card-box { width: 100%; height: 100%; background: #000; border: 3px solid #fff; border-radius: 8px; overflow: hidden; position: relative; }
    .card-img { width: 100%; height: 100%; object-fit: cover; }
    .vs-text { font-family: 'Bangers'; font-size: 40px; color: #ff0055; -webkit-text-stroke: 1px #fff; z-index: 10; }
    .mystery-overlay { 
        position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
        background: repeating-linear-gradient(45deg, #111, #111 10px, #222 10px, #222 20px);
        display: flex; justify-content: center; align-items: center; cursor: pointer;
    }
    .char-name { font-family: 'Bangers'; font-size: 18px; text-transform: uppercase; margin-top: 5px; text-shadow: 2px 2px 0 #000; }

    /* --- MODE 2 : EMOJI (Texte) --- */
    #mode-emoji { display: none; width: 100%; max-width: 400px; flex-direction: column; align-items: center; }
    .emoji-display {
        font-size: 60px; margin: 30px 0; padding: 20px;
        background: rgba(255,255,255,0.1); border-radius: 15px; border: 2px dashed rgba(255,255,255,0.3);
        text-align: center; width: 100%; min-height: 120px; display: flex; justify-content: center; align-items: center;
        text-shadow: 0 4px 0 rgba(0,0,0,0.5);
    }
    .input-box {
        width: 100%; padding: 15px; font-family: 'Komika Axis'; font-size: 18px; text-align: center;
        border: 3px solid #000; border-radius: 8px; margin-bottom: 15px;
        text-transform: uppercase;
    }
    .feedback-msg { font-family: 'Bangers'; font-size: 24px; margin: 10px 0; text-shadow: 2px 2px 0 #000; display: none; }
    .correct-text { color: #4eff3b; }
    .wrong-text { color: #ff0055; }
    .solution-text { color: #ffcc00; font-size: 20px; margin-bottom: 10px; display: none; }

</style>
</head>
<body>

    <div id="menu-screen" class="screen active">
        <div class="menu-overlay"></div>
        <div class="menu-content">
            <h1 class="app-title">MANGA<br>QUIZ HUB</h1>
            <div id="quiz-list-container"></div>
        </div>
    </div>

    <div id="game-screen" class="screen">
        <button class="btn-back" onclick="showScreen('menu-screen')">‚¨Ö MENU</button>

        <div class="header-zone">
            <div class="game-title" id="roundTitle">ROUND 1</div>
        </div>

        <div id="mode-duel">
            <div class="duel-container">
                <div class="card-wrapper">
                    <div class="card-box">
                        <img id="img-left" src="" class="card-img" onerror="this.src='https://placehold.co/200x300?text=IMG+MISSING'">
                    </div>
                    <div class="char-name" id="name-left">NOM</div>
                </div>
                <div class="vs-text">VS</div>
                <div class="card-wrapper">
                    <div class="card-box" onclick="revealCard()">
                        <img id="img-right" src="" class="card-img" onerror="this.src='https://placehold.co/200x300?text=IMG+MISSING'">
                        <div class="mystery-overlay" id="overlay-right">
                            <div class="mystery-text">?</div>
                        </div>
                    </div>
                    <div class="char-name" id="name-right">???</div>
                </div>
            </div>
            <button class="btn-action btn-next" id="btn-next-duel" onclick="nextRound()">SUIVANT ‚ñ∂</button>
        </div>

        <div id="mode-emoji">
            <div class="emoji-display" id="emoji-text">üëí‚ò†Ô∏èüçñ</div>
            
            <input type="text" id="user-input" class="input-box" placeholder="C'est qui ?">
            
            <div id="emoji-buttons">
                <button class="btn-action btn-next" id="btn-validate" style="display:block; width:100%;" onclick="checkEmojiAnswer()">VALIDER</button>
            </div>

            <div id="feedback-area" style="text-align:center; width: 100%;">
                <div class="feedback-msg" id="msg-correct">‚úÖ BONNE R√âPONSE !</div>
                <div class="feedback-msg" id="msg-wrong">‚ùå MAUVAISE R√âPONSE...</div>
                <div class="solution-text" id="solution-display">C'√âTAIT : LUFFY</div>
                
                <div id="retry-buttons" style="display:none; justify-content:center; margin-top:10px;">
                    <button class="btn-action btn-retry" onclick="resetEmojiInput()">R√âESSAYER</button>
                    <button class="btn-action btn-reveal" onclick="showEmojiSolution()">R√âPONSE</button>
                </div>
                
                <button class="btn-action btn-next" id="btn-next-emoji" onclick="nextRound()">QUESTION SUIVANTE ‚ñ∂</button>
            </div>
        </div>

    </div>

<script>
    // ----------------------------------------------------
    // DATA : IMAGE POOL (Ton ancienne liste)
    // ----------------------------------------------------
    const OP_POOL = [
        { name: "Monkey D. Luffy", img: "luffy.jpg" }, { name: "Roronoa Zoro", img: "zoro.jpg" },
        { name: "Nami", img: "nami.jpg" }, { name: "Usopp", img: "usopp.jpg" },
        { name: "Sanji", img: "sanji.jpg" }, { name: "Chopper", img: "chopper.jpg" },
        { name: "Nico Robin", img: "robin.jpg" }, { name: "Franky", img: "franky.jpg" },
        { name: "Brook", img: "brook.jpg" }, { name: "Jinbe", img: "jinbe.jpg" },
        { name: "Trafalgar Law", img: "law.jpg" }, { name: "Eustass Kid", img: "kid.jpg" },
        { name: "Shanks", img: "shanks.jpg" }, { name: "Buggy", img: "buggy.jpg" },
        { name: "Mihawk", img: "mihawk.jpg" }, { name: "Crocodile", img: "crocodile.jpg" },
        { name: "Doflamingo", img: "doflamingo.jpg" }, { name: "Boa Hancock", img: "hancock.jpg" },
        { name: "Whitebeard", img: "whitebeard.jpg" }, { name: "Marco", img: "marco.jpg" },
        { name: "Ace", img: "ace.jpg" }, { name: "Sabo", img: "sabo.jpg" },
        { name: "Blackbeard", img: "blackbeard.jpg" }, { name: "Akainu", img: "akainu.jpg" },
        { name: "Aokiji", img: "kuzan.jpg" }, { name: "Kizaru", img: "kizaru.jpg" },
        { name: "Fujitora", img: "fujitora.jpg" }, { name: "Kaido", img: "kaido.jpg" },
        { name: "Big Mom", img: "bigmom.jpg" }, { name: "Yamato", img: "yamato.jpg" }
    ];
    const CREW_ROLES = ["CAPITAINE", "BRAS DROIT", "NAVIGATEUR", "CUISINIER", "M√âDECIN", "SNIPER", "CHARPENTIER", "MUSICIEN"];

    // ----------------------------------------------------
    // DATA : EMOJI POOL (Nouvelle liste)
    // answers: mets toutes les orthographes accept√©es (minuscules)
    // ----------------------------------------------------
    const EMOJI_POOL = [
        { emojis: "üëí‚ò†Ô∏èüçñ", answers: ["luffy", "monkey d luffy", "mugiwara"] },
        { emojis: "‚öîÔ∏èüü¢üç∂üí§", answers: ["zoro", "roronoa zoro"] },
        { emojis: "üçäüó∫Ô∏èüí∞üå©Ô∏è", answers: ["nami"] },
        { emojis: "ü§•üéØüå±üî®", answers: ["usopp", "pipo"] },
        { emojis: "üö¨üë®‚Äçüç≥ü¶µüî•", answers: ["sanji", "sangoro"] },
        { emojis: "ü¶åü©∫üç¨üß¢", answers: ["chopper", "tony tony chopper"] },
        { emojis: "üñêÔ∏èüå∏üìöüè∫", answers: ["robin", "nico robin"] },
        { emojis: "ü§ñü•§üîßü©≤", answers: ["franky", "cutty flam"] },
        { emojis: "üíÄüéªüéº‚òï", answers: ["brook"] },
        { emojis: "ü¶àü•ãüåä‚òÄÔ∏è", answers: ["jinbe", "jimbe"] },
        { emojis: "üêØü©∫üíâüé©", answers: ["law", "trafalgar law"] },
        { emojis: "üß≤ü¶æüé∏üå∑", answers: ["kid", "eustass kid"] },
        { emojis: "üî•üç©ü™µü§†", answers: ["ace", "portgas d ace"] },
        { emojis: "üé©üî•üêâüß£", answers: ["sabo"] },
        { emojis: "üççüê¶üîµüî•", answers: ["marco"] },
        { emojis: "üî¥ü§°üí£üé™", answers: ["buggy", "baggy"] },
        { emojis: "üêä‚åõüö¨üåµ", answers: ["crocodile"] },
        { emojis: "ü¶©üï∂Ô∏èüß∂ü§¥", answers: ["doflamingo", "dofy"] },
        { emojis: "üêçüóøüòçüë†", answers: ["hancock", "boa hancock"] },
        { emojis: "ü¶Öüó°Ô∏è‚úùÔ∏èüö£", answers: ["mihawk"] },
        { emojis: "üë¥üåäüç™üëä", answers: ["garp"] },
        { emojis: "üç©üç°üß£üê≤", answers: ["katakuri"] },
        { emojis: "üê≤üå©Ô∏èüëπüç∂", answers: ["kaido"] },
        { emojis: "üéÇüå©Ô∏èüëµüè¥‚Äç‚ò†Ô∏è", answers: ["big mom", "linlin"] },
        { emojis: "üê∂üëπ‚ùÑÔ∏èü•í", answers: ["yamato"] },
        { emojis: "üí®üö¨üèçÔ∏èüå´Ô∏è", answers: ["smoker"] },
        { emojis: "üêÜüé©üï¥Ô∏èüê¶", answers: ["lucci", "rob lucci"] },
        { emojis: "üåãüëäüß¢‚öñÔ∏è", answers: ["akainu", "sakazuki"] },
        { emojis: "‚ùÑÔ∏èüö≤üêßüò¥", answers: ["aokiji", "kuzan"] },
        { emojis: "‚ú®üï∂Ô∏èüí°üêµ", answers: ["kizaru", "borsalino"] },
        { emojis: "üíúüêØüé≤‚öîÔ∏è", answers: ["fujitora", "issho"] },
        { emojis: "üå≥üêÇüè†üü¢", answers: ["ryokugyu", "aramaki"] },
        { emojis: "üê≥üë¥üéºüõ§Ô∏è", answers: ["laboon"] },
        { emojis: "‚úÇÔ∏èüé©ÂΩ±ü¶á", answers: ["moria", "gecko moria"] },
        { emojis: "üêªüêæüìñüëì", answers: ["kuma", "bartholomew kuma"] },
        { emojis: "ü§¥üëë‚ùåüåç", answers: ["imu", "im"] },
        { emojis: "üêòüó°Ô∏èüå´Ô∏èüèúÔ∏è", answers: ["jack"] },
        { emojis: "ü¶ïü¶†üéªü§í", answers: ["queen"] },
        { emojis: "ü¶ñüî•üó°Ô∏èüëë", answers: ["king"] },
        { emojis: "üê∞‚ö°ü•ïüåï", answers: ["carrot"] },
        { emojis: "ü¶†üçèü•ßüßî", answers: ["blackbeard", "barbe noire", "teach"] },
        { emojis: "üî±üë¥üç∂üåç", answers: ["whitebeard", "barbe blanche", "newgate"] },
        { emojis: "üëëüè¥‚Äç‚ò†Ô∏èüßî‚öîÔ∏è", answers: ["roger", "gold roger"] },
        { emojis: "üëìüó°Ô∏èü•àüëë", answers: ["rayleigh"] },
        { emojis: "üëª‚òÇÔ∏èüè∞üë∏", answers: ["perona"] },
        { emojis: "‚ö°üçéüëÇüåù", answers: ["enel", "ener"] },
        { emojis: "ü¶†ü§¢üë®‚Äç‚öïÔ∏èüçè", answers: ["doc q"] },
        { emojis: "ü§•ü§•ü§•ü§•", answers: ["usopp"] },
        { emojis: "üç¨üç≠üëÖüé©", answers: ["perospero"] },
        { emojis: "üó°Ô∏èüó°Ô∏èüó°Ô∏èüó°Ô∏è", answers: ["hatchan"] },
        { emojis: "ü¶µü¶µüíéüçó", answers: ["blue gilly"] },
        { emojis: "üõ°Ô∏èüêìüü¢üò¨", answers: ["bartolomeo"] },
        { emojis: "üê¥üí§ü§¥üåπ", answers: ["cavendish", "hakuba"] },
        { emojis: "üå∏üç°üëòüó°Ô∏è", answers: ["kinemon"] },
        { emojis: "üé®üñåÔ∏èüå©Ô∏èüéé", answers: ["kanjuro"] },
        { emojis: "üêàüî´üåôüêµ", answers: ["nekomamushi"] },
        { emojis: "üêïüó°Ô∏è‚òÄÔ∏èü¶¥", answers: ["inuarashi"] },
        { emojis: "üèØüêâüëòüîû", answers: ["momonosuke"] },
        { emojis: "üë∂üß™üç¨üç≠", answers: ["caesar", "caesar clown"] },
        { emojis: "ü¶äü•äüí®üèÅ", answers: ["foxy"] },
        { emojis: "üßºüöøüêëüëµ", answers: ["kalifa"] },
        { emojis: "ü¶íüó°Ô∏èüß±üèóÔ∏è", answers: ["kaku"] },
        { emojis: "üê∫üçΩÔ∏èüçúüëñ", answers: ["jabru"] }
    ];

    // ----------------------------------------------------
    // CONFIGURATION DES QUIZ
    // ----------------------------------------------------
    const QUIZ_CONFIG = [
        {
            id: "op_crew_random",
            type: "duel",
            title: "COMPOSE TON √âQUIPAGE",
            icon: "üè¥‚Äç‚ò†Ô∏è",
            bg: "linear-gradient(135deg, #006994 0%, #003366 100%)",
            mode: "random_pool",
            pool: OP_POOL,
            roles: CREW_ROLES
        },
        {
            id: "op_emoji_100",
            type: "emoji",
            title: "DEVINE LE PERSONNAGE (EMOJI)",
            icon: "üß©",
            bg: "linear-gradient(135deg, #4b6cb7 0%, #182848 100%)",
            pool: EMOJI_POOL,
            questionCount: 5
        }
    ];

    // Variables globales
    let currentQuizConfig = null;
    let activeQuestions = [];
    let currentQuestionIndex = 0;

    // --- MENU ---
    const menuContainer = document.getElementById('quiz-list-container');
    QUIZ_CONFIG.forEach(quiz => {
        const btn = document.createElement('div');
        btn.className = 'quiz-card';
        btn.innerHTML = `
            <div style="display:flex; align-items:center;">
                <span class="quiz-icon">${quiz.icon}</span>
                <div class="quiz-info">
                    <span class="quiz-tag">${quiz.type === 'emoji' ? 'QUIZ TEXTE' : 'VISUEL'}</span>
                    <h3>${quiz.title}</h3>
                </div>
            </div>
            <div style="font-size:24px;">‚ñ∂</div>
        `;
        btn.onclick = () => startQuiz(quiz.id);
        menuContainer.appendChild(btn);
    });

    // --- NAVIGATION ---
    function showScreen(screenId) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(screenId).classList.add('active');
    }

    // --- G√âN√âRATEURS ---
    function generateRandomDuels(pool, roles) {
        let tempPool = [...pool].sort(() => Math.random() - 0.5);
        let questions = [];
        for (let i = 0; i < roles.length; i++) {
            if (tempPool.length < 2) break;
            questions.push({ title: roles[i], left: tempPool.pop(), right: tempPool.pop() });
        }
        return questions;
    }

    function generateRandomEmojis(pool, count) {
        let tempPool = [...pool].sort(() => Math.random() - 0.5);
        return tempPool.slice(0, count);
    }

    // --- LANCEMENT JEU ---
    function startQuiz(quizId) {
        currentQuizConfig = QUIZ_CONFIG.find(q => q.id === quizId);
        currentQuestionIndex = 0;
        document.getElementById('game-screen').style.background = currentQuizConfig.bg;

        // Reset display
        document.getElementById('mode-duel').style.display = "none";
        document.getElementById('mode-emoji').style.display = "none";

        if (currentQuizConfig.type === "duel") {
            document.getElementById('mode-duel').style.display = "flex";
            activeQuestions = generateRandomDuels(currentQuizConfig.pool, currentQuizConfig.roles);
        } else if (currentQuizConfig.type === "emoji") {
            document.getElementById('mode-emoji').style.display = "flex";
            activeQuestions = generateRandomEmojis(currentQuizConfig.pool, currentQuizConfig.questionCount);
        }

        loadQuestion();
        showScreen('game-screen');
    }

    function loadQuestion() {
        if (currentQuestionIndex >= activeQuestions.length) {
            alert("Quiz Termin√© !");
            showScreen('menu-screen');
            return;
        }

        const data = activeQuestions[currentQuestionIndex];
        
        // Mettre √† jour le titre
        document.getElementById('roundTitle').innerText = 
            (currentQuizConfig.type === "duel") ? data.title : `QUESTION ${currentQuestionIndex + 1} / ${activeQuestions.length}`;

        if (currentQuizConfig.type === "duel") {
            loadDuel(data);
        } else {
            loadEmoji(data);
        }
    }

    // --- LOGIQUE DUEL ---
    function loadDuel(data) {
        document.getElementById('overlay-right').style.display = 'flex';
        document.getElementById('btn-next-duel').style.display = 'none';
        
        document.getElementById('img-left').src = data.left.img;
        document.getElementById('name-left').innerText = data.left.name;
        
        document.getElementById('img-right').src = data.right.img;
        document.getElementById('name-right').innerText = "???";
        document.getElementById('name-right').style.opacity = "0.5";
        document.getElementById('game-screen').dataset.hiddenName = data.right.name;
    }

    function revealCard() {
        document.getElementById('overlay-right').style.display = 'none';
        document.getElementById('name-right').innerText = document.getElementById('game-screen').dataset.hiddenName;
        document.getElementById('name-right').style.opacity = "1";
        document.getElementById('btn-next-duel').style.display = 'block';
    }

    // --- LOGIQUE EMOJI ---
    function loadEmoji(data) {
        document.getElementById('emoji-text').innerText = data.emojis;
        
        // Reset Inputs
        const input = document.getElementById('user-input');
        input.value = "";
        input.disabled = false;
        input.focus(); // Ouvre le clavier si possible
        
        // Reset UI Feedback
        document.getElementById('msg-correct').style.display = "none";
        document.getElementById('msg-wrong').style.display = "none";
        document.getElementById('solution-display').style.disp
